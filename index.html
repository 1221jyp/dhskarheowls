<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>2025 ë°°êµ¬ ë¦¬ê·¸</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-bracket/0.11.1/jquery.bracket.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/jquery-bracket/0.11.1/jquery.bracket.min.css"
    />
    <style>
      .score-box {
        border: 1px solid #ccc;
        border-radius: 8px;
        min-height: 150px;
        text-align: center;
        background-color: #f8f9fa;
        margin-bottom: 1rem;
        padding: 0.5rem;
        overflow: auto;
      }
      .first-place {
        background-color: #d4edda; /* ì—°í•œ ì´ˆë¡ */
      }
      .wildcard {
        background-color: #fff3cd; /* ì—°í•œ ë…¸ë‘ */
      }
      .schedule-male {
        background-color: #d0ebff; /* ì—°íŒŒë‘ */
      }
      .schedule-female {
        background-color: #ffe0e0; /* ì—°ë¶„í™ */
      }
      .content-section {
        display: none;
      }
      .content-section.active {
        display: block;
      }
      .tournament-bracket {
        margin: 20px 0;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: #f8f9fa;
      }
      .bracket-container {
        min-height: 400px;
        display: flex;
        justify-content: center;
        align-items: center;
      }
    </style>
  </head>
  <body class="p-0">
    <header class="text-white p-3" style="background-color: #000">
      <div
        class="container d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center"
      >
        <h1 class="h4 m-0">2025 ì˜¤ë‚¨ê³  ë°°êµ¬ ëŸ°ì¹˜ë¦¬ê·¸</h1>
      </div>
    </header>

    <div class="container mt-4">
      <div class="mt-2" id="mainNavigation">
        <div class="row g-2 mb-4">
          <!-- ë³¸ì„  ë²„íŠ¼ë“¤ -->
          <div class="col-12 col-md-4">
            <button class="btn btn-outline-success w-100" onclick="showSection('grade1-main')">
              1í•™ë…„ ë³¸ì„ 
            </button>
          </div>
          <div class="col-12 col-md-4">
            <button class="btn btn-outline-success w-100" onclick="showSection('grade2-main')">
              2í•™ë…„ ë³¸ì„ 
            </button>
          </div>
          <div class="col-12 col-md-4">
            <button class="btn btn-outline-success w-100" onclick="showSection('grade3-main')">
              3í•™ë…„ ë³¸ì„ 
            </button>
          </div>
          <!-- ì˜ˆì„  ê²°ê³¼ ë²„íŠ¼ë“¤ -->
          <div class="col-12 col-md-4">
            <button class="btn btn-outline-primary w-100" onclick="showSection('grade1-prelim')">
              1í•™ë…„ ì˜ˆì„  ê²°ê³¼
            </button>
          </div>
          <div class="col-12 col-md-4">
            <button class="btn btn-outline-primary w-100" onclick="showSection('grade2-prelim')">
              2í•™ë…„ ì˜ˆì„  ê²°ê³¼
            </button>
          </div>
          <div class="col-12 col-md-4">
            <button class="btn btn-outline-primary w-100" onclick="showSection('grade3-prelim')">
              3í•™ë…„ ì˜ˆì„  ê²°ê³¼
            </button>
          </div>
        </div>
      </div>

      <!-- ë²”ë¡€ -->
      <div class="mt-3" id="legend" style="display: none">
        <div class="d-flex flex-wrap align-items-center gap-3">
          <div class="d-flex align-items-center">
            <div
              style="
                width: 20px;
                height: 20px;
                background-color: #d4edda;
                border: 1px solid #ccc;
                margin-right: 5px;
              "
            ></div>
            <span>í† ë„ˆë¨¼íŠ¸ ì§„ì¶œ</span>
          </div>
          <div class="d-flex align-items-center">
            <div
              style="
                width: 20px;
                height: 20px;
                background-color: #fff3cd;
                border: 1px solid #ccc;
                margin-right: 5px;
              "
            ></div>
            <span>ì™€ì¼ë“œì¹´ë“œ íŒ€</span>
          </div>
        </div>
      </div>

      <!-- ì˜ˆì„  ê²°ê³¼ ì„¹ì…˜ë“¤ -->
      <div class="content-section" id="grade1-prelim">
        <div class="row mb-4" id="grade1-content">
          <!-- JSë¡œ 1í•™ë…„ ì˜ˆì„  ê²°ê³¼ ì‚½ì… -->
        </div>
      </div>

      <div class="content-section" id="grade2-prelim">
        <div class="row mb-4" id="grade2-content">
          <!-- JSë¡œ 2í•™ë…„ ì˜ˆì„  ê²°ê³¼ ì‚½ì… -->
        </div>
      </div>

      <div class="content-section" id="grade3-prelim">
        <div class="row mb-4" id="grade3-content">
          <!-- JSë¡œ 3í•™ë…„ ì˜ˆì„  ê²°ê³¼ ì‚½ì… -->
        </div>
      </div>

      <!-- ë³¸ì„  í† ë„ˆë¨¼íŠ¸ ì„¹ì…˜ë“¤ -->
      <div class="content-section" id="grade1-main">
        <h2 class="mb-4">1í•™ë…„ ë³¸ì„  í† ë„ˆë¨¼íŠ¸ (13:05 ~ )</h2>
        <div class="tournament-bracket">
          <h4>ë‚¨ìë¶€</h4>
          <div class="bracket-container" id="grade1-male-bracket"></div>
        </div>
        <div class="tournament-bracket">
          <h4>ì—¬ìë¶€</h4>
          <div class="bracket-container" id="grade1-female-bracket"></div>
        </div>
      </div>

      <div class="content-section" id="grade2-main">
        <h2 class="mb-4">2í•™ë…„ ë³¸ì„  í† ë„ˆë¨¼íŠ¸ (13:20 ~ )</h2>
        <div class="tournament-bracket">
          <h4>ë‚¨ìë¶€</h4>
          <div class="bracket-container" id="grade2-male-bracket"></div>
        </div>
        <div class="tournament-bracket">
          <h4>ì—¬ìë¶€</h4>
          <div class="bracket-container" id="grade2-female-bracket"></div>
        </div>
      </div>

      <div class="content-section" id="grade3-main">
        <h2 class="mb-4">3í•™ë…„ ë³¸ì„  í† ë„ˆë¨¼íŠ¸ (13:35 ~ )</h2>
        <div class="tournament-bracket">
          <h4>ë‚¨ìë¶€</h4>
          <div class="bracket-container" id="grade3-male-bracket"></div>
        </div>
        <div class="tournament-bracket">
          <h4>ì—¬ìë¶€</h4>
          <div class="bracket-container" id="grade3-female-bracket"></div>
        </div>
      </div>
    </div>

    <script>
      let scoreData = {};
      let schedules = {};
      let currentSection = null;

      const finalMatchSchedules = {
        1: {
          male: [
            "7ì›” 1ì¼(í™”) - ì¤€ê²°ìŠ¹ 1ê²½ê¸°: 11ë°˜ vs 8ë°˜",
            "7ì›” 2ì¼(ìˆ˜) - ì¤€ê²°ìŠ¹ 2ê²½ê¸°: 6ë°˜ vs 7ë°˜",
            "7ì›” 3ì¼(ëª©) - 3Â·4ìœ„ì „",
            "7ì›” 7ì¼(ì›”) - ê²°ìŠ¹ì „",
          ],
          female: [
            "7ì›” 1ì¼(í™”) - ì¤€ê²°ìŠ¹ 1ê²½ê¸°: 2ë°˜ vs 9ë°˜",
            "7ì›” 2ì¼(ìˆ˜) - ì¤€ê²°ìŠ¹ 2ê²½ê¸°: 3ë°˜ vs 12ë°˜",
            "7ì›” 3ì¼(ëª©) - 3Â·4ìœ„ì „",
            "7ì›” 4ì¼(ê¸ˆ) - ê²°ìŠ¹ì „",
          ],
        },
        2: {
          male: [
            "7ì›” 1ì¼(í™”) - ì¤€ê²°ìŠ¹ 1ê²½ê¸°: 5ë°˜ vs 7ë°˜",
            "7ì›” 2ì¼(ìˆ˜) - ì¤€ê²°ìŠ¹ 2ê²½ê¸°: 2ë°˜ vs 4ë°˜",
            "7ì›” 3ì¼(ëª©) - 3Â·4ìœ„ì „",
            "7ì›” 7ì¼(ì›”) - ê²°ìŠ¹ì „",
          ],
          female: [
            "7ì›” 1ì¼(í™”) - ì¤€ê²°ìŠ¹ 1ê²½ê¸°: 3ë°˜ vs 8ë°˜",
            "7ì›” 2ì¼(ìˆ˜) - ì¤€ê²°ìŠ¹ 2ê²½ê¸°: 1ë°˜ vs 10ë°˜",
            "7ì›” 3ì¼(ëª©) - 3Â·4ìœ„ì „",
            "7ì›” 4ì¼(ê¸ˆ) - ê²°ìŠ¹ì „",
          ],
        },
        3: {
          male: [
            "7ì›” 1ì¼(í™”) - ì¤€ê²°ìŠ¹ 1ê²½ê¸°: 4ë°˜ vs 7ë°˜",
            "7ì›” 2ì¼(ìˆ˜) - ì¤€ê²°ìŠ¹ 2ê²½ê¸°: 3ë°˜ vs 1ë°˜",
            "7ì›” 3ì¼(ëª©) - 3Â·4ìœ„ì „",
            "7ì›” 7ì¼(ì›”) - ê²°ìŠ¹ì „",
          ],
          female: [
            "7ì›” 1ì¼(í™”) - ì¤€ê²°ìŠ¹ 1ê²½ê¸°: 4ë°˜ vs 2ë°˜",
            "7ì›” 2ì¼(ìˆ˜) - ì¤€ê²°ìŠ¹ 2ê²½ê¸°: 12ë°˜ vs 6ë°˜",
            "7ì›” 3ì¼(ëª©) - 3Â·4ìœ„ì „",
            "7ì›” 4ì¼(ê¸ˆ) - ê²°ìŠ¹ì „",
          ],
        },
      };

      function renderFinalMatchSchedule(grade) {
        const container = document.querySelector(`#grade${grade}-main`);
        const schedule = finalMatchSchedules[grade];
        if (!schedule) return;

        const maleItems = schedule.male
          .map((line) => `<li class="list-group-item schedule-male">${line}</li>`)
          .join("");
        const femaleItems = schedule.female
          .map((line) => `<li class="list-group-item schedule-female">${line}</li>`)
          .join("");

        const scheduleHTML = `
        <div class="mt-5 mb-5">
          <h4>ğŸ“… ${grade}í•™ë…„ ë³¸ì„  ê²½ê¸° ì¼ì •</h4>

          <h5 class="mt-3">ë‚¨ìë¶€</h5>
          <ul class="list-group mb-4">
            ${maleItems}
          </ul>

          <h5>ì—¬ìë¶€</h5>
          <ul class="list-group">
            ${femaleItems}
          </ul>
        </div>
      `;

        container.insertAdjacentHTML("beforeend", scheduleHTML);
      }

      const gradeGroupMap = {
        1: [
          "1í•™ë…„-ë‚¨ìë¶€-Aì¡°",
          "1í•™ë…„-ë‚¨ìë¶€-Bì¡°",
          "1í•™ë…„-ë‚¨ìë¶€-Cì¡°",
          "1í•™ë…„-ì—¬ìë¶€-Aì¡°",
          "1í•™ë…„-ì—¬ìë¶€-Bì¡°",
          "1í•™ë…„-ì—¬ìë¶€-Cì¡°",
        ],
        2: [
          "2í•™ë…„-ë‚¨ìë¶€-Aì¡°",
          "2í•™ë…„-ë‚¨ìë¶€-Bì¡°",
          "2í•™ë…„-ë‚¨ìë¶€-Cì¡°",
          "2í•™ë…„-ì—¬ìë¶€-Aì¡°",
          "2í•™ë…„-ì—¬ìë¶€-Bì¡°",
          "2í•™ë…„-ì—¬ìë¶€-Cì¡°",
        ],
        3: ["3í•™ë…„-ë‚¨ìë¶€-Aì¡°", "3í•™ë…„-ë‚¨ìë¶€-Bì¡°", "3í•™ë…„-ì—¬ìë¶€-Aì¡°", "3í•™ë…„-ì—¬ìë¶€-Bì¡°"],
      };

      // í† ë„ˆë¨¼íŠ¸ ìƒ˜í”Œ ë°ì´í„° (ì‹¤ì œë¡œëŠ” ì˜ˆì„  ê²°ê³¼ì—ì„œ ê°€ì ¸ì™€ì•¼ í•¨)
      const tournamentData = {
        1: {
          male: {
            teams: [
              ["11ë°˜", "8ë°˜"],
              ["6ë°˜", "7ë°˜"],
            ],
            results: [
              [19, 21],
              [21, 8],
            ],
          },
          female: {
            teams: [
              ["2ë°˜", "9ë°˜"],
              ["3ë°˜", "12ë°˜"],
            ],
            results: [
              [21, 18],
              [8, 21],
            ],
          },
        },
        2: {
          male: {
            teams: [
              ["5ë°˜", "7ë°˜"],
              ["2ë°˜", "4ë°˜"],
            ],
            results: [
              [16, 21],
              [21, 15],
            ],
          },
          female: {
            teams: [
              ["3ë°˜", "8ë°˜"],
              ["1ë°˜", "10ë°˜"],
            ],
            results: [
              [16, 21],
              [14, 21],
            ],
          },
        },
        3: {
          male: {
            teams: [
              ["4ë°˜", "7ë°˜"],
              ["3ë°˜", "1ë°˜"],
            ],
            results: [
              [21, 14],
              [21, 15],
            ],
          },
          female: {
            teams: [
              ["4ë°˜", "2ë°˜"],
              ["12ë°˜", "6ë°˜"],
            ],
            results: [
              [21, 17],
              [7, 21],
            ],
          },
        },
      };

      function showSection(sectionId) {
        // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
        document.querySelectorAll(".content-section").forEach((section) => {
          section.classList.remove("active");
        });

        // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„±í™”
        document.querySelectorAll("#mainNavigation button").forEach((btn) => {
          btn.classList.remove("btn-primary", "btn-success");
          if (btn.textContent.includes("ì˜ˆì„ ")) {
            btn.classList.add("btn-outline-primary");
          } else {
            btn.classList.add("btn-outline-success");
          }
        });

        // ì„ íƒëœ ì„¹ì…˜ í™œì„±í™”
        const selectedSection = document.getElementById(sectionId);
        if (selectedSection) {
          selectedSection.classList.add("active");
          currentSection = sectionId;

          // ì„ íƒëœ ë²„íŠ¼ í™œì„±í™”
          const selectedButton = event.target;
          selectedButton.classList.remove("btn-outline-primary", "btn-outline-success");
          if (selectedButton.textContent.includes("ì˜ˆì„ ")) {
            selectedButton.classList.add("btn-primary");
            document.getElementById("legend").style.display = "block";
          } else {
            selectedButton.classList.add("btn-success");
            document.getElementById("legend").style.display = "none";
          }

          // í•´ë‹¹ ì„¹ì…˜ ë‚´ìš© ë¡œë“œ
          if (sectionId.includes("prelim")) {
            loadPrelimResults(sectionId);
          } else if (sectionId.includes("main")) {
            loadTournamentBracket(sectionId);
          }
        }
      }

      function loadPrelimResults(sectionId) {
        const grade = parseInt(sectionId.replace("grade", "").replace("-prelim", ""));
        const groups = gradeGroupMap[grade];
        const contentId = `grade${grade}-content`;

        const maleGroups = groups.filter((g) => g.includes("ë‚¨ìë¶€"));
        const femaleGroups = groups.filter((g) => g.includes("ì—¬ìë¶€"));

        const makeSection = (title, groupList) => {
          const boxes = groupList
            .map((group) => {
              const data = scoreData[group] || {};
              return createScoreBox(group, data);
            })
            .join("");
          return `<h4 class="mt-4 mb-3">${title}</h4><div class="row">${boxes}</div>`;
        };

        const html = makeSection("ë‚¨ìë¶€", maleGroups) + makeSection("ì—¬ìë¶€", femaleGroups);
        document.getElementById(contentId).innerHTML = html;

        // ì¼ì • í‘œì‹œ ì¶”ê°€
        renderSchedule(grade, contentId);
      }

      function loadTournamentBracket(sectionId) {
        const grade = parseInt(sectionId.replace("grade", "").replace("-main", ""));

        // ë‚¨ìë¶€ í† ë„ˆë¨¼íŠ¸
        const maleData = tournamentData[grade].male;
        $(`#grade${grade}-male-bracket`).bracket({
          init: {
            teams: maleData.teams,
            results: maleData.results,
          },
        });

        // ì—¬ìë¶€ í† ë„ˆë¨¼íŠ¸
        const femaleData = tournamentData[grade].female;
        $(`#grade${grade}-female-bracket`).bracket({
          init: {
            teams: femaleData.teams,
            results: femaleData.results,
          },
        });

        renderFinalMatchSchedule(grade);
      }

      function renderSchedule(grade, containerId) {
        const container = document.getElementById(containerId);
        const list = schedules[grade] || [];

        const scheduleHtml = `
              <h4 class="mt-4">ğŸ“… ${grade}í•™ë…„ ê²½ê¸° ì¼ì •</h4>
              <ul class="list-group">
                ${list
                  .map((row) => {
                    const genderClass = row.ì„±ë³„ === "ë‚¨" ? "schedule-male" : "schedule-female";
                    if (row.ìŠ¹íŒ€) {
                      return `<li class="list-group-item ${genderClass}">${row.ë‚ ì§œ} | ${row.ì„±ë³„}ì ${row.ì¡°} | ${row.ê²½ê¸°} â†’ ${row.ìŠ¹íŒ€}ë°˜ ìŠ¹ (${row.ì ìˆ˜ìŠ¹}:${row.ì ìˆ˜íŒ¨})</li>`;
                    } else {
                      return `<li class="list-group-item ${genderClass}">${row.ë‚ ì§œ} | ${row.ì„±ë³„}ì ${row.ì¡°} | ${row.ê²½ê¸°} (ì˜ˆì •)</li>`;
                    }
                  })
                  .join("")}
              </ul>
            `;

        container.innerHTML += scheduleHtml;
      }

      // ê°œì„ ëœ ìˆœìœ„ ì •ë ¬ í•¨ìˆ˜
      function sortTeamsByRanking(data) {
        const teams = Object.entries(data);

        // ìŠ¹ì ë³„ë¡œ ê·¸ë£¹í™”
        const groupsByPoints = {};
        teams.forEach(([team, stats]) => {
          const points = stats.ìŠ¹ì ;
          if (!groupsByPoints[points]) {
            groupsByPoints[points] = [];
          }
          groupsByPoints[points].push([team, stats]);
        });

        let sortedTeams = [];

        // ê° ìŠ¹ì  ê·¸ë£¹ë³„ë¡œ ì •ë ¬
        Object.keys(groupsByPoints)
          .sort((a, b) => b - a) // ìŠ¹ì  ë†’ì€ ìˆœ
          .forEach((points) => {
            const group = groupsByPoints[points];

            if (group.length === 1) {
              // í˜¼ìì¸ ê²½ìš° ê·¸ëŒ€ë¡œ ì¶”ê°€
              sortedTeams.push(...group);
            } else if (group.length === 2) {
              // 2íŒ€ì¸ ê²½ìš° ë§ëŒ€ê²°ë¡œ ê²°ì •
              const [teamA, teamB] = group;
              const [nameA, statsA] = teamA;
              const [nameB, statsB] = teamB;

              if (statsA.ë§ëŒ€ê²°?.[nameB] === "ìŠ¹") {
                sortedTeams.push(teamA, teamB);
              } else {
                sortedTeams.push(teamB, teamA);
              }
            } else {
              // 3íŒ€ ì´ìƒì¸ ê²½ìš° ë“ì‹¤ì°¨ë¡œ ë°”ë¡œ ê²°ì •
              const sortedGroup = group.sort((a, b) => {
                const diffA = a[1].ì´ì  - a[1].ì‹¤ì ;
                const diffB = b[1].ì´ì  - b[1].ì‹¤ì ;
                return diffB - diffA; // ë“ì‹¤ì°¨ ë†’ì€ ìˆœ
              });
              sortedTeams.push(...sortedGroup);
            }
          });

        return sortedTeams;
      }

      function createScoreBox(groupName, data) {
        const sorted = sortTeamsByRanking(data);

        const rows = sorted
          .map((entry, idx) => {
            const [team, stats] = entry;
            const isThirdGrade = groupName.startsWith("3í•™ë…„");

            // ì™€ì¼ë“œì¹´ë“œ í‘œì‹œ ê°œì„ 
            let rowClass = "";
            if (idx === 0 || (isThirdGrade && idx === 1)) {
              rowClass = "first-place";
            } else if (stats.isWildcard === true) {
              rowClass = "wildcard";
            }

            return `
                  <div class="row ${rowClass}">
                    <div class="col">${idx + 1}ìœ„</div>
                    <div class="col">${team}</div>
                    <div class="col">${stats.ìŠ¹}</div>
                    <div class="col">${stats.íŒ¨}</div>
                    <div class="col">${stats.ìŠ¹ì }</div>
                    <div class="col">${stats.ì´ì  - stats.ì‹¤ì }</div>
                  </div>`;
          })
          .join("");

        return `
              <div class="col-12 col-lg-6 col-xl-4">
                <div class="score-box">
                  <h3 class="mb-1 border-bottom mb-2">${groupName}</h3>
                  <div class="row fw-bold border-bottom mb-1 pb-1">
                    <div class="col">ìˆœìœ„</div>
                    <div class="col">ë°˜</div>
                    <div class="col">ìŠ¹</div>
                    <div class="col">íŒ¨</div>
                    <div class="col">ìŠ¹ì </div>
                    <div class="col">ë“ì‹¤</div>
                  </div>
                  ${rows}
                </div>
              </div>`;
      }

      // JSON íŒŒì¼ ë¡œë“œ
      Promise.all([
        fetch("íŒ€ë³„ì ìˆ˜.json").then((res) => res.json()),
        fetch("í•™ë…„ë³„ê²½ê¸°ì¼ì •.json")
          .then((res) => res.json())
          .catch(() => ({})),
      ])
        .then(([scores, schedule]) => {
          scoreData = scores;
          schedules = schedule;
          // ì´ˆê¸° í˜ì´ì§€ëŠ” ë¹ˆ ìƒíƒœë¡œ ìœ ì§€ (ë²„íŠ¼ë§Œ í‘œì‹œ)
        })
        .catch((error) => {
          console.error("JSON íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨:", error);
          alert(
            "ë°ì´í„° íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŒ€ë³„ì ìˆ˜.json íŒŒì¼ì´ ê°™ì€ í´ë”ì— ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”."
          );
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
